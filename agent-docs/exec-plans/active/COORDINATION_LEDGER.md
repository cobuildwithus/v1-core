# Coordination Ledger (Active Only)

Use this file only for currently active coding work. Keep it minimal and current.

## Open Entries

| Agent/Session | Task | Files in Scope | Symbols (add/rename/delete) | Dependency Notes | Updated (YYYY-MM-DD) |
| --- | --- | --- | --- | --- | --- |
| codex-gpt5-goal-reassert-grace-parity-2026-02-26 | Add goal treasury one-time post-deadline reassert grace with shared grace helpers/getters and budget-goal parity semantics | `src/goals/library/TreasuryReassertGrace.sol`, `src/goals/GoalTreasury.sol`, `src/goals/BudgetTreasury.sol`, `src/interfaces/ISuccessAssertionTreasury.sol`, `src/interfaces/IGoalTreasury.sol`, `src/interfaces/IBudgetTreasury.sol`, `test/goals/GoalTreasury.t.sol`, `test/goals/BudgetTreasury.t.sol`, `test/goals/UMATreasurySuccessResolver.t.sol`, `ARCHITECTURE.md`, `agent-docs/cobuild-protocol-architecture.md`, `agent-docs/product-specs/protocol-lifecycle-and-invariants.md`, `agent-docs/references/goal-funding-and-reward-map.md`, `agent-docs/exec-plans/active/2026-02-26-goal-reassert-grace-parity.md`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add `TreasuryReassertGrace` library + shared grace getter surface (`reassertGraceDeadline`, `reassertGraceUsed`, `isReassertGraceActive`) on success-assertion treasuries; add goal `ReassertGraceActivated` event and goal grace state-machine branches | Hard cutover allowed (no live deployments); preserve single-slot UMA resolver behavior and treasury-specific funding/finalization invariants | 2026-02-26 |
| codex-gpt5-shared-budget-router-simplify-pass1-2026-02-26 | Completion workflow pass 1 (`simplify`) for shared budget router stack changes | `src/allocation-strategies/BudgetFlowRouterStrategy.sol`, `src/tcr/BudgetTCR.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | none planned (behavior-preserving simplification only) | Respect active ownership boundaries; no `lib/**`; no interface or behavior changes | 2026-02-26 |
| codex-gpt5-budget-router-strategy-shared-2026-02-26 | Replace per-budget budget-flow strategy deployment with one shared per-goal router strategy and one-time child-flow registration | `src/allocation-strategies/BudgetFlowRouterStrategy.sol`, `src/interfaces/IBudgetFlowRouterStrategy.sol`, `src/tcr/BudgetTCR.sol`, `src/tcr/BudgetTCRDeployer.sol`, `src/tcr/interfaces/IBudgetTCRStackDeployer.sol`, `src/tcr/library/BudgetTCRStackDeploymentLib.sol`, `test/BudgetTCRDeployments.t.sol`, `test/BudgetTCRBudgetTreasuryInvariant.t.sol`, `agent-docs/cobuild-protocol-architecture.md`, `agent-docs/references/goal-funding-and-reward-map.md`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add `BudgetFlowRouterStrategy` + `IBudgetFlowRouterStrategy`; add stack-deployer child-flow registration entrypoint; route BudgetTCR stack activation through shared strategy registration | Hard cutover (no live deployments); preserve fail-closed allocation reads and child-sync account-key invariants | 2026-02-26 |
| codex-gpt5-goal-stake-vault-strategy-consolidation-2026-02-26 | Remove standalone `GoalStakeVaultStrategy` by making `GoalStakeVault` the goal-flow allocation strategy/resolver | `src/goals/GoalStakeVault.sol`, `src/interfaces/IGoalStakeVault.sol`, `src/goals/GoalFactory.sol`, `src/allocation-strategies/GoalStakeVaultStrategy.sol`, `test/goals/GoalStakeVault.t.sol`, `test/goals/GoalStakeVaultStrategy.t.sol`, `test/goals/GoalRevnetIntegration.t.sol`, `test/flows/FlowBudgetStakeAutoSync.t.sol`, `scripts/build-nozip-review-prompt.sh`, `ARCHITECTURE.md`, `agent-docs/cobuild-protocol-architecture.md`, `agent-docs/references/goal-funding-and-reward-map.md`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add strategy-capability functions on `GoalStakeVault` (`allocationKey`, `accountForAllocationKey`, `currentWeight`, `canAllocate`, `canAccountAllocate`, `accountAllocationWeight`, `strategyKey`, `stakeVault`); extend `IGoalStakeVault` with goal-ledger strategy capabilities; delete standalone `GoalStakeVaultStrategy` contract/file | Hard cutover allowed (no live deployments); preserve goal-ledger mode validation invariants and default-strategy semantics while avoiding `lib/**` | 2026-02-26 |
| codex-gpt5-flowrates-negative-revert-2026-02-26 | Normalize negative flow-rate invariant semantics by enforcing `FLOW_RATE_NEGATIVE` at `FlowRates.calculateFlowRates` boundary | `src/library/FlowRates.sol`, `test/flows/FlowRates.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | none planned | Scoped defensive invariant hardening only; preserve existing rate-split behavior and interface surface | 2026-02-26 |
| codex-gpt5-constants-centralization-2026-02-26 | Centralize remaining implicit-unit/gas stipend constants and improve unit docs | `src/library/FlowProtocolConstants.sol`, `src/library/FlowUnitMath.sol`, `src/allocation-strategies/SingleAllocatorStrategy.sol`, `src/hooks/GoalFlowAllocationLedgerPipeline.sol`, `src/library/GoalFlowLedgerMode.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add `UNIT_WEIGHT_SCALE`, `SINGLE_ALLOCATOR_VIRTUAL_WEIGHT`, `GOAL_LEDGER_CHILD_SYNC_GAS_STIPEND`, `GOAL_LEDGER_BUDGET_TREASURY_SYNC_GAS_STIPEND`; remove local duplicates in listed modules | Keep runtime behavior unchanged; centralize values and units only | 2026-02-26 |
| codex-gpt5-goal-failed-coverage-audit-2026-02-25 | Coverage-audit direct call paths for GoalState failed-enum cutover and realign stale terminal-state test constants | `test/goals/RewardEscrow.t.sol`, `test/goals/RewardEscrowIntegration.t.sol`, `test/invariant/RewardEscrow.invariant.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | delete legacy test alias `GOAL_FAILED`; realign non-success finalize constants to enum-derived `Expired` | Keep coverage intent unchanged while removing stale ordinal assumptions that mask terminal-state regressions | 2026-02-25 |
| codex-gpt5-flow-unit-naming-ppm-pct-2026-02-26 | Normalize flow allocation and rate unit naming to explicit `_Ppm`/`_Pct` semantics and remove ambiguous percent naming | `src/interfaces/IFlow.sol`, `src/flows/CustomFlow.sol`, `src/library/FlowInitialization.sol`, `src/library/FlowRates.sol`, `src/library/FlowAllocations.sol`, `src/library/CustomFlowAllocationEngine.sol`, `src/storage/FlowStorage.sol`, `src/Flow.sol`, `test/flows/**`, `test/BudgetTCRFlowRemovalLiveness.t.sol`, `test/harness/TestableCustomFlow.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | rename `percentAllocations` -> `allocationsPpm`; rename `INVALID_RATE_PERCENT` -> `INVALID_RATE_PPM`; rename `EXTRA_BUFFER_PERCENT` -> `EXTRA_BUFFER_PCT`; rename local vars/comments to explicit units | Preserve behavior; naming/unit clarity only (no scale changes) | 2026-02-26 |
| codex-gpt5-flowalloc-apply-unchecked-2026-02-25 | Make FlowAllocations apply entrypoints explicitly unchecked to avoid validation-assumption misuse | `src/library/FlowAllocations.sol`, `src/library/CustomFlowAllocationEngine.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | rename `applyAllocationWithPreviousStateCalldata` -> `applyAllocationWithPreviousStateCalldataUnchecked`; rename `applyAllocationWithPreviousStateMemory` -> `applyAllocationWithPreviousStateMemoryUnchecked` | Preserve runtime behavior and gas profile; keep validation at explicit caller boundary | 2026-02-25 |
| codex-gpt5-treasury-flow-sync-fallback-2026-02-25 | Make treasury flow-rate sync best-effort when zero-rate final fallback write reverts | `src/goals/library/TreasuryFlowRateSync.sol`, `test/goals/GoalTreasury.t.sol`, `test/goals/BudgetTreasury.t.sol` | add `FlowRateSyncManualInterventionRequired` event | Keep sync non-reverting on fallback failure; preserve existing fallback write order and finalize-path behavior | 2026-02-25 |
| codex-gpt5-metadata-invariant-2026-02-25 | Enforce metadata validation invariants for `setDescription` and add regression coverage | `src/Flow.sol`, `test/flows/FlowInitializationAndAccessSetters.t.sol` | none planned | Keep setter behavior but reject empty description to preserve global metadata assumptions | 2026-02-25 |
| codex-gpt5-branch-coverage-lift-2026-02-25 | Raise branch coverage toward CI floor via high-yield tests only (slither deferred) | `test/**`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | none planned | Do not modify `lib/**`; avoid touching active production-file ownership unless strictly required | 2026-02-25 |
| codex-gpt5-indexer-event-simplification-2026-02-25 | Remove old indexer ordering coupling by making lifecycle indexing rely on explicit Flow/BudgetTCR events (no per-allocation new events) | `src/Flow.sol`, `src/tcr/BudgetTCR.sol`, `src/interfaces/IFlow.sol`, `src/tcr/interfaces/IBudgetTCR.sol`, `test/BudgetTCR*.t.sol`, `test/flows/FlowInitializationAndAccess*.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add missing emit sites for existing `IBudgetTCR` lifecycle/sync events; add init-time `MetadataSet` emit; remove ordering-coupling comments/docs; no new hot-path allocation event symbols | Preserve gas profile by reusing existing events and avoid unit-event-driven lifecycle deletes in downstream indexers | 2026-02-25 |
| codex-gpt5-test-fix-budget-stake-ledger-2026-02-25 | Fix failing tests in required gate (`BudgetStakeLedgerBranchCoverage` slot drift + `FlowRates` stale assertions) | `test/goals/BudgetStakeLedgerBranchCoverage.t.sol`, `test/flows/FlowRates.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | none planned | Keep behavior unchanged; realign test expectations/helpers with current protocol/runtime semantics | 2026-02-25 |
| codex-gpt5-event-signature-adjustments-2026-02-25 | Implement event-surface/indexer schema adjustments across flow, pipeline, treasury, staking, escrow, and budget stack modules | `src/Flow.sol`, `src/interfaces/**`, `src/hooks/GoalFlowAllocationLedgerPipeline.sol`, `src/goals/RewardEscrow.sol`, `src/goals/GoalStakeVault.sol`, `src/tcr/BudgetTCR*.sol`, related tests under `test/flows/**`, `test/goals/**`, `test/BudgetTCR*.t.sol`, `agent-docs/exec-plans/active/2026-02-25-event-signature-surface-adjustments.md`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add canonical flow-rate update event; expand init/config events; add parent-context child-sync events; replace per-claim escrow events with unified claim event; add snapshot allocation commit event and remove per-recipient allocation event; adjust event argument names/order/indexing where required | Prioritize gas reduction and indexer ergonomics; preserve lifecycle/funds invariants; do not revert unrelated in-flight edits | 2026-02-25 |
| codex-gpt5-remove-metaevidence-slot-2026-02-25 | Remove unused `metaEvidenceUpdates` storage slot now that no live deployments exist | `src/tcr/storage/GeneralizedTCRStorageV1.sol`, `test/GeneralizedTCRGovernanceUpgrade.t.sol`, `test/BudgetTCR.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | delete `metaEvidenceUpdates` state var and remove test references to getter | No live deployments per repo policy; keep behavior checks on active fields/events only | 2026-02-25 |
| codex-gpt5-juror-lock-regression-check-2026-02-25 | Verify whether locked juror stake becomes unwithdrawable after `markGoalResolved` by adding focused regression coverage | `test/goals/GoalStakeVault.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add test `test_regression_postResolutionJurorLock_canExitAndWithdraw` | Test-only scope; no production symbol changes planned | 2026-02-25 |
| codex-gpt5-tcr-arbitration-cost-decimal-bounds-2026-02-26 | Remove implicit `1e18` arbitration-cost bound assumptions by binding bounds to explicit enforced voting-token unit constants | `src/tcr/storage/ArbitratorStorageV1.sol`, `test/ERC20VotesArbitratorInitConfigUpgrade.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add `VOTING_TOKEN_DECIMALS`; add `VOTING_TOKEN_UNIT`; no external ABI/symbol renames | Keep behavior unchanged while making the 18-decimal unit contractually explicit and aligned with init-time token-decimals enforcement | 2026-02-26 |
| codex-gpt5-goalfactory-stack-and-scripts-2026-02-26 | Add `GoalFactory` full goal stack deployer plus Foundry deploy scripts using deterministic `BudgetTCR` address prediction | `src/goals/GoalFactory.sol`, `src/interfaces/external/revnet/IREVDeployer.sol`, `script/DeployGoalFactory.s.sol`, `script/DeployGoalFromFactory.s.sol`, `test/goals/GoalFactory.t.sol` (if coverage pass adds tests), `agent-docs/exec-plans/active/2026-02-26-goal-factory-deployment-stack.md`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add `GoalFactory` contract and deployment structs/events/errors; add external `IREVDeployer` interface; add deploy scripts | Maintain atomic initialization and existing treasury/flow/TCR invariants while introducing a single-tx goal stack deployment path | 2026-02-26 |
| codex-gpt5-goalfactory-coverage-audit-pass-2026-02-26 | Coverage-audit `GoalFactory` deploy path wiring introduced by REV deployer ABI alignment | `test/goals/GoalFactory.t.sol`, `agent-docs/exec-plans/active/COORDINATION_LEDGER.md` | add focused coverage tests + test-only deployer/directory probes for `DIRECTORY().primaryTerminalOf` and `deployFor(0, ...)` argument wiring assertions | User-scoped pass only; do not edit production Solidity/scripts | 2026-02-26 |

## Rules

1. Add a row before your first code edit for every coding task (single-agent and multi-agent).
2. Update your row immediately when scope or symbol-change intent changes.
3. Before deleting or renaming a symbol, check this table for dependencies.
4. Delete your row as soon as the task is complete or abandoned.
5. Leave only the header and empty table when there is no active work.
